<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>交易界面</title>
    <style>
        body {
            background-color: white;
            font-family: Arial, sans-serif;
        }
        .container {
            width: 95%;
            margin: 0 auto;
            text-align: center;
        }
        .button {
            background-color: #f0f0f0;
            border: none;
            padding: 10px 20px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
            display: block;
            width: 100%;
            box-sizing: border-box;
            color: black;
            font-size: 16px;
        }
        .button-row {
            display: flex;
            justify-content: space-between;
        }
        .button-row .button {
            width: 48%;
        }
        .toggle-button {
            display: flex;
            position: relative;
            margin: 5px 0;
            height: 40px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .toggle-button button {
            width: 50%;
            z-index: 1;
            position: relative;
            background-color: transparent;
            border: none;
            padding: 10px;
            cursor: pointer;
            font-size: 16px;
            color: black;
        }
        .slider {
            position: absolute;
            top: 5%;
            height: 90%;
            background-color: #fff;
            border-radius: 5px;
            transition: 0.4s;
        }
        .margin-slider {
            width: 48%;
            left: 2%;
        }
        .toggle-button.active .margin-slider {
            left: 50%;
        }
        .stock-slider {
            width: 49%;
        }
        .toggle-button.active .stock-slider {
            left: 50%;
        }
        .button-buy {
            background-color: #4caf50;
            color: white;
        }
        .button-sell {
            background-color: #f44336;
            color: white;
        }
        .price-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
        }
        .price-control, .quantity-control {
            display: flex;
            align-items: center;
            border: 1px solid #ccc;
            border-radius: 5px;
            overflow: hidden;
            width: 48%;
        }
        .price-control button, .quantity-control button {
            background-color: #fff;
            border: none;
            padding: 5px;
            font-size: 25px;
            cursor: pointer;
            color: black;
            width: 20%;
        }
        .price-control input, .quantity-control input {
            text-align: center;
            border: none;
            font-size: 20px;
            background-color: #fff;
            margin: 0;
            padding: 10px 0;
            width: 60%;
        }
        .quantity-control span {
            font-size: 12px;
            color: #999;
        }
        .info {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            font-size: 16px;
        }
        .chart {
            height: 300px;
            margin: 20px 0;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="chart">
            K線圖
        </div>
        <div class="button-row">
            <div class="toggle-button" id="margin-toggle">
                <button onclick="toggleMargin('left')">全倉</button>
                <button onclick="toggleMargin('right')">逐倉</button>
                <div class="slider margin-slider" id="margin-slider"></div>
            </div>
            <button class="button">10x</button>
        </div>
        <div class="toggle-button" id="toggle-button">
            <button onclick="toggleSlide('left')">整張</button>
            <button onclick="toggleSlide('right')">零股</button>
            <div class="slider stock-slider" id="slider" style="left: 1%;"></div>
        </div>
        <div class="price-container">
            <div class="price-control">
                <button onclick="adjustPrice(-1)">－</button>
                <input type="number" id="price-input" value="963.00"> <!-- 修改這行，將type改為number，並移除readonly -->
                <button onclick="adjustPrice(1)">＋</button>
            </div>
            <div class="quantity-control">
                <button onclick="adjustQuantity(-1)">－</button>
                <input type="number" id="quantity-input" value="1"> <!-- 修改這行，將type改為number，並移除readonly -->
                <span id="unit-label">張</span>
                <button onclick="adjustQuantity(1)">＋</button>
            </div>
        </div>
        <div class="info">
            <span>預估金額</span>
            <span id="estimated-amount">963,000</span>
        </div>
        <div class="info">
            <span>可用</span>
            <span>1,000</span>
        </div>

        <button class="button button-buy">買入（做多）</button>
        <button class="button button-sell">賣出（做空）</button>
    </div>

    <script>
        function toggleSlide(direction) {
            var slider = document.getElementById('slider');
            var unitLabel = document.getElementById('unit-label');
            if (direction === 'left') {
                slider.style.left = '1%';
                unitLabel.innerText = '張';
            } else {
                slider.style.left = '50%';
                unitLabel.innerText = '股';
            }
            updateEstimatedAmount();
        }

        function toggleMargin(direction) {
            var slider = document.getElementById('margin-slider');
            if (direction === 'left') {
                slider.style.left = '2%';
            } else {
                slider.style.left = '50%';
            }
        }

        function adjustPrice(direction) {
            var priceInput = document.getElementById('price-input');
            var price = parseFloat(priceInput.value);
            if (price < 10) {
                price += direction * 0.01;
            } else if (price < 50) {
                price += direction * 0.05;
            } else if (price < 100) {
                price += direction * 0.1;
            } else if (price < 500) {
                price += direction * 0.5;
            } else if (price < 1000) {
                price += direction * 1;
            } else {
                price += direction * 5;
            }
            if (price < 0) price = 0;
            priceInput.value = price.toFixed(2);
            updateEstimatedAmount();
        }

        function adjustQuantity(direction) {
            var quantityInput = document.getElementById('quantity-input');
            var quantity = parseInt(quantityInput.value);
            quantity += direction;
            if (quantity <= 0) quantity = 1;
            quantityInput.value = quantity;
            updateEstimatedAmount();
        }

        function updateEstimatedAmount() {
            var price = parseFloat(document.getElementById('price-input').value);
            var quantity = parseInt(document.getElementById('quantity-input').value);
            var unit = document.getElementById('unit-label').innerText;
            var estimatedAmount = price * quantity;
            if (unit === '張') {
                estimatedAmount *= 1000;
            }
            document.getElementById('estimated-amount').innerText = numberWithCommas(trimTrailingZeros(estimatedAmount.toFixed(2)));
        }

        function trimTrailingZeros(numStr) {
            return numStr.replace(/(\.\d*[1-9])0+$/, "$1").replace(/\.0+$/, "");
        }

        function numberWithCommas(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        document.getElementById('price-input').addEventListener('input', function() {
            var priceInput = document.getElementById('price-input');
            var price = parseFloat(priceInput.value);
            if (isNaN(price) || price < 0) {
                priceInput.value = 0;
            } else {
                priceInput.value = price.toFixed(2);
            }
            updateEstimatedAmount();
        }); // 添加這段，用於監聽price-input的變更事件

        document.getElementById('quantity-input').addEventListener('input', function() {
            var quantityInput = document.getElementById('quantity-input');
            var quantity = parseInt(quantityInput.value);

            if (isNaN(quantity) || quantity < 1) {
                quantityInput.value = 1;
            }
            updateEstimatedAmount();
            }); // 添加這段，用於監聽quantity-input的變更事件
        </script>
</body>
</html>
